<!DOCTYPE html>
<html>
<head>
  <title>Nonprofit Revenue Model Explorer</title>
  <style>
    body { font-family: Arial; margin: 20px; }
    .slider { width: 300px; }
    .output { margin-top: 20px; }
    .positive { color: green; }
    .negative { color: red; }
    button { margin-top: 10px; padding: 5px 10px; }
    .input-box { width: 80px; margin-left: 10px; }
  </style>
  <script>
    // Password protection
    let password = prompt("Enter password to access the Nonprofit Revenue Model Explorer:");
    if (password !== "davids" && password !== "grant" && password !== "k") {
      alert("Incorrect password. Access denied.");
      window.location = "about:blank";
    }
  </script>
</head>
<body>
  <h2>Nonprofit Revenue Model Explorer (monthly)</h2>
  <p>Note: Option 1 and 2 default to values to get the same revenue as the current model at -90% ad spend ROI. <br> Option 3 optimizes for all—0% revenue share at $0, hits 10% at $1,000 revenue (20% if full setup), and scales cleanly from there.</p>
  <label title="Monthly Google Ad Grants spend per org">Ad Spend ($/month): <input type="range" min="0" max="10000" value="10000" id="adSpend" class="slider" oninput="update()"></label>
  <span id="adSpendValue">10000</span><br>
  <label title="Extra sales generated by ads per org">Incremental Revenue ($/month): 
    <input type="range" min="0" max="15000" value="1000" id="revenue" class="slider" oninput="updateRevenueInput()">
    <input type="number" min="0" max="15000" value="1000" id="revenueInput" class="input-box" oninput="updateRevenueSlider()" autocomplete="off">
  </label>
  <span id="revenueValue">1000</span><br>
  <label title="Fixed % of ad spend as a base fee">Groas Base Fee (%): <input type="range" min="0" max="5" step="0.1" value="2" id="baseFee" class="slider" oninput="update()"></label>
  <span id="baseFeeValue">2</span><br>
  <label title="% of incremental revenue shared">Revenue Share (%): <input type="range" min="0" max="50" value="0" id="revShare" class="slider" oninput="update()"></label>
  <span id="revShareValue">0</span><br>
  <label title="Your % of total fees collected">Your Split (%): <input type="range" min="0" max="100" value="50" id="yourSplit" class="slider" oninput="update()"></label>
  <span id="yourSplitValue">50</span><br>
  <label title="Number of nonprofits in the model">Number of Orgs: <input type="range" min="1" max="200" value="1" id="numOrgs" class="slider" oninput="update()"></label>
  <span id="numOrgsValue">1</span><br>

  <button onclick="setOption1()">Option 1: Pure Revenue-Share</button>
  <button onclick="setOption2()">Option 2: Revenue-Share + Min Fee</button>
  <button onclick="setOption3()">Option 3: Optimized Equilibrium</button>
  <button onclick="reset()">Reset to Defaults</button>

  <div style="margin-top: 20px; max-width: 600px;">
    <p><b>How Option 3 Works (Optimized Equilibrium):</b></p>
    <p>The algorithm ensures zero risk for nonprofits by only charging from new revenue, starting at 0% at $0 and scaling to 10% at $1,000 (20% for full setup). It optimizes for all—Groas gets a steady minimum and upside to set up and maintain optimized accounts, I scale with revenue, and nonprofits keep most of their gains.</p>
  </div>

  <div class="output">
    <p>Nonprofit Cost (Total): $<span id="nonprofitCost">200</span></p>
    <p>Groas Fee: $<span id="groasFee">100</span></p>
    <p>David A Fee: $<span id="yourFee">100</span></p>
    <p>Nonprofit Net Gain: $<span id="netGain">800</span></p>
    <p>Orgs Needed for $20k: <span id="orgsNeeded">200</span></p>
  </div>

  <div style="margin-top: 20px; max-width: 600px;">
    <p><b>Nonprofit Pitch Preview:</b></p>
    <p>Turn your FREE $10,000/month Google Ad Grant into new revenue for your program-related event registration, merch, or other sales! Zero risk, all upside! We optimize your ads with AI to boost sales or registrations. No upfront cost—our cut starts at 0% at $0 revenue, hits 10% at $1,000 (20% if we set up your AdWords from scratch), and caps there. You keep the majority of every new dollar earned from your free advertising credits!</p>
  </div>

<script>
  function update() {
    let adSpend = parseFloat(document.getElementById("adSpend").value);
    let revenue = parseFloat(document.getElementById("revenue").value);
    let baseFee = parseFloat(document.getElementById("baseFee").value);
    let revShare = parseFloat(document.getElementById("revShare").value);
    let yourSplit = parseFloat(document.getElementById("yourSplit").value);
    let numOrgs = parseFloat(document.getElementById("numOrgs").value);

    document.getElementById("adSpendValue").innerText = adSpend;
    document.getElementById("revenueValue").innerText = revenue;
    document.getElementById("baseFeeValue").innerText = baseFee;
    document.getElementById("revShareValue").innerText = revShare;
    document.getElementById("yourSplitValue").innerText = yourSplit;
    document.getElementById("numOrgsValue").innerText = numOrgs;

    let nonprofitCostPerOrg;
    // New stepped logic from 0 to $1000 for all caps
    let baseCost = adSpend * (baseFee / 100);
    let threshold = 0; // Start at $0
    let maxRevShare = revShare; // Slider cap
    let stepRange = 1000; // 0 to $1000 range
    let dynamicP = revenue <= threshold ? 0 : 
                   revenue <= stepRange ? maxRevShare * (revenue / stepRange) :
                   maxRevShare;
    let revShareCost = (dynamicP / 100) * revenue;
    nonprofitCostPerOrg = baseCost + revShareCost;

// Risk adjustment
let totalCost = nonprofitCostPerOrg * numOrgs;
let groasFeePerOrg = nonprofitCostPerOrg * ((100 - yourSplit) / 100);
let yourFeePerOrg = nonprofitCostPerOrg * (yourSplit / 100);
let groasFee = groasFeePerOrg * numOrgs;
let yourFee = yourFeePerOrg * numOrgs;
let netGain = (revenue * numOrgs) - totalCost;

if (numOrgs <= 3 && groasFeePerOrg < 100) {
  let shortfallPerOrg = 100 - groasFeePerOrg; // Your risk, up to $100/org
  groasFee = 100 * numOrgs; // Groas gets minimum
  yourFee = groasFee - shortfallPerOrg * numOrgs; // Adjust your fee, can go negative
  totalCost = groasFee + yourFee; // Nonprofit cost is sum of fees
  netGain = (revenue * numOrgs) - totalCost; // Net gain reflects actual cost
} else if (numOrgs > 3 && groasFeePerOrg < 100) {
  let shortfallPerOrg = (100 - groasFeePerOrg) / 2; // Shared risk
  groasFee += shortfallPerOrg * numOrgs;
  yourFee -= shortfallPerOrg * numOrgs;
  totalCost = groasFee + yourFee; // Nonprofit cost is sum of fees
  netGain = (revenue * numOrgs) - totalCost; // Net gain reflects actual cost
}
if (totalCost > revenue * numOrgs) {
  totalCost = revenue * numOrgs; // Cap total cost at revenue
  netGain = 0; // Nonprofit breaks even
}

    document.getElementById("nonprofitCost").innerText = Math.round(totalCost);
    document.getElementById("groasFee").innerText = Math.round(groasFee);
    document.getElementById("yourFee").innerText = Math.round(yourFee);
    document.getElementById("netGain").innerText = Math.round(netGain);
    document.getElementById("netGain").className = netGain >= 0 ? "positive" : "negative";
    document.getElementById("orgsNeeded").innerText = yourFeePerOrg > 0 ? Math.ceil(20000 / yourFeePerOrg) : "N/A";

    drawChart(); // Add chart update
  }

  function updateRevenueInput() {
    let revenue = parseFloat(document.getElementById("revenue").value);
    document.getElementById("revenueInput").value = revenue;
    update();
  }

  function updateRevenueSlider() {
    let revenueInput = document.getElementById("revenueInput").value;
    if (revenueInput === "" || isNaN(revenueInput)) {
      revenueInput = 0; // Handle empty or invalid input
    } else {
      revenueInput = parseFloat(revenueInput);
    }
    if (revenueInput >= 0 && revenueInput <= 15000) {
      document.getElementById("revenue").value = revenueInput;
    } else if (revenueInput < 0) {
      document.getElementById("revenue").value = 0;
      document.getElementById("revenueInput").value = 0;
    } else {
      document.getElementById("revenue").value = 15000;
      document.getElementById("revenueInput").value = 15000;
    }
    update();
  }

  function setOption1() {
    document.getElementById("adSpend").value = 10000;
    document.getElementById("baseFee").value = 0;
    document.getElementById("revShare").value = 20;
    document.getElementById("yourSplit").value = 50;
    document.getElementById("numOrgs").value = 1;
    update();
  }

  function setOption2() {
    document.getElementById("adSpend").value = 10000;
    document.getElementById("baseFee").value = 0.5;
    document.getElementById("revShare").value = 15;
    document.getElementById("yourSplit").value = 50;
    document.getElementById("numOrgs").value = 1;
    update();
  }

  function setOption3() {
    document.getElementById("adSpend").value = 10000;
    document.getElementById("revenue").value = 1000;
    document.getElementById("revenueInput").value = 1000;
    document.getElementById("baseFee").value = 1;
    document.getElementById("revShare").value = 10; // Base case, tweak to 20 for full setup
    document.getElementById("yourSplit").value = 50;
    document.getElementById("numOrgs").value = 1;
    update();
  }

  function reset() {
    document.getElementById("adSpend").value = 10000;
    document.getElementById("revenue").value = 1000;
    document.getElementById("revenueInput").value = 1000;
    document.getElementById("baseFee").value = 2;
    document.getElementById("revShare").value = 0;
    document.getElementById("yourSplit").value = 50;
    document.getElementById("numOrgs").value = 1;
    update();
  }

  function drawChart() {
    const canvas = document.getElementById("revenueChart");
    const ctx = canvas.getContext("2d");
    const values = [
      parseFloat(document.getElementById("nonprofitCost").innerText),
      parseFloat(document.getElementById("groasFee").innerText),
      parseFloat(document.getElementById("yourFee").innerText),
      parseFloat(document.getElementById("netGain").innerText)
    ];
    const labels = ["Nonprofit Cost", "Groas Fee", "David A Fee", "Net Gain"];
    const colors = ["#ff6384", "#36a2eb", "#ffcd56", "#4bc0c0"];
    const maxValue = Math.max(...values.map(Math.abs), 1000); // Scale to max or 1000

    // Clear canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw bars
    const barWidth = 80;
    const spacing = 20;
    const startX = 20;
    const baseY = canvas.height - 20;

    for (let i = 0; i < values.length; i++) {
      const height = (values[i] / maxValue) * (canvas.height - 40);
      const x = startX + i * (barWidth + spacing);
      const y = values[i] >= 0 ? baseY - height : baseY;

      ctx.fillStyle = colors[i];
      ctx.fillRect(x, y, barWidth, values[i] >= 0 ? height : -height);

      // Label
      ctx.fillStyle = "#000";
      ctx.font = "12px Arial";
      ctx.textAlign = "center";
      ctx.fillText(labels[i], x + barWidth / 2, baseY + 15);
      ctx.fillText(`$${values[i]}`, x + barWidth / 2, y - 5 * (values[i] >= 0 ? 1 : -1));
    }

    // Zero line
    ctx.beginPath();
    ctx.moveTo(0, baseY);
    ctx.lineTo(canvas.width, baseY);
    ctx.strokeStyle = "#ccc";
    ctx.stroke();
  }

  window.onload = function() {
    update(); // Initial call includes chart
  };
</script>
<div style="margin-top: 20px;">
  <h3>Revenue Breakdown</h3>
  <canvas id="revenueChart" width="400" height="200"></canvas>
</div>
</body>
</html>
